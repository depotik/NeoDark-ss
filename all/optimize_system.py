import os
import sys
import platform
import subprocess
import psutil
import time
from datetime import datetime

def print_header():
    """–í—ã–≤–æ–¥–∏—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    print("üîß –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã NeoDark")
    print("=" * 50)

def get_system_info():
    """–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ"""
    print("üíª –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ...")
    
    system_info = {
        "platform": platform.system(),
        "release": platform.release(),
        "version": platform.version(),
        "machine": platform.machine(),
        "processor": platform.processor(),
        "ram_total": round(psutil.virtual_memory().total / (1024**3), 2),
        "ram_available": round(psutil.virtual_memory().available / (1024**3), 2),
        "cpu_count": psutil.cpu_count(logical=False),
        "cpu_threads": psutil.cpu_count(logical=True),
        "cpu_freq": psutil.cpu_freq().current if psutil.cpu_freq() else "N/A",
        "disk_usage": psutil.disk_usage('/').percent if platform.system() != "Windows" else psutil.disk_usage('C:\\').percent
    }
    
    print(f"   –û–°: {system_info['platform']} {system_info['release']}")
    print(f"   –í–µ—Ä—Å–∏—è: {system_info['version']}")
    print(f"   –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: {system_info['processor']}")
    print(f"   –Ø–¥–µ—Ä: {system_info['cpu_count']}, –ü–æ—Ç–æ–∫–æ–≤: {system_info['cpu_threads']}")
    print(f"   –ß–∞—Å—Ç–æ—Ç–∞ CPU: {system_info['cpu_freq']} MHz" if system_info['cpu_freq'] != "N/A" else "   –ß–∞—Å—Ç–æ—Ç–∞ CPU: N/A")
    print(f"   –û–ó–£ –≤—Å–µ–≥–æ: {system_info['ram_total']} GB")
    print(f"   –û–ó–£ –¥–æ—Å—Ç—É–ø–Ω–æ: {system_info['ram_available']} GB")
    print(f"   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞: {system_info['disk_usage']}%")
    print()
    
    return system_info

def clean_memory():
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏"""
    print("üß† –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏...")
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    memory_before = psutil.virtual_memory()
    
    try:
        # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (Linux/macOS)
        if platform.system() in ["Linux", "Darwin"]:
            try:
                # –û—á–∏—Å—Ç–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –∫—ç—à–∞, dentries –∏ inodes
                subprocess.run(["sync"], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
                print("   ‚úÖ –°–±—Ä–æ—Å –±—É—Ñ–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã")
            except:
                print("   ‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å —Å–±—Ä–æ—Å–∏—Ç—å –±—É—Ñ–µ—Ä—ã —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã")
        
        # –ò–º–∏—Ç–∞—Ü–∏—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
        # –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å –≤—ã–∑–æ–≤—ã –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –∫—ç—à–µ–π
        print("   ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ —è–¥—Ä–æ–º")
        print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞–º—è—Ç–∏")
        
    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏: {e}")
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    memory_after = psutil.virtual_memory()
    
    ram_cleared = (memory_before.available - memory_after.available) / (1024**2)  # –≤ MB
    print(f"   üìä –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ: {max(0, ram_cleared):.2f} MB")
    print()

def optimize_startup():
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏"""
    print("üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏...")
    
    system = platform.system()
    
    if system == "Windows":
        try:
            # –í Windows –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–µ–µ—Å—Ç—Ä–æ–º –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
            print("   ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏")
            print("   ‚ö†Ô∏è  –î–ª—è –ø–æ–ª–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞")
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º PowerShell –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
            startup_cmd = [
                "powershell", 
                "-Command", 
                "Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location | Format-Table -AutoSize"
            ]
            
            result = subprocess.run(startup_cmd, capture_output=True, text=True, timeout=10)
            if result.returncode == 0:
                lines = result.stdout.strip().split('\n')
                if len(lines) > 3:  # –ï—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ
                    print(f"   üìä –ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ: {len(lines) - 3}")
                else:
                    print("   üìä –ü—Ä–æ–≥—Ä–∞–º–º—ã –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
            else:
                print("   ‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏")
                
        except subprocess.TimeoutExpired:
            print("   ‚ö†Ô∏è  –¢–∞–π–º-–∞—É—Ç –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏")
        except Exception as e:
            print(f"   ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏: {e}")
    
    elif system == "Linux":
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏")
        print("   üìä –ê–Ω–∞–ª–∏–∑ systemd —Å–µ—Ä–≤–∏—Å–æ–≤")
        
    elif system == "Darwin":  # macOS
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ LaunchAgents –∏ LaunchDaemons")
        print("   üìä –ê–Ω–∞–ª–∏–∑ plist —Ñ–∞–π–ª–æ–≤")
    
    print()

def defragment_disk():
    """–ò–º–∏—Ç–∞—Ü–∏—è –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∏—Å–∫–∞"""
    print("üíΩ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∏—Å–∫–æ–≤–æ–π –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã...")
    
    system = platform.system()
    
    if system == "Windows":
        print("   ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏")
        print("   ‚ö†Ô∏è  –î–ª—è –ø–æ–ª–Ω–æ–π –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞")
        print("   üîÑ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MFT (Master File Table)")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤")
        
    else:
        print("   ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã")
        print("   üîÑ –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–≤")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã inode")
    
    # –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    for i in range(5):
        print(f"   ‚è≥ –ü—Ä–æ–≥—Ä–µ—Å—Å: {((i+1)*20)}%", end='\r')
        time.sleep(0.5)
    print("   ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
    print()

def clean_system_junk():
    """–û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞"""
    print("üóëÔ∏è  –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞...")
    
    try:
        # –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ —Å–∏—Å—Ç–µ–º—ã
        if platform.system() == "Linux":
            print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–æ–≤")
            print("   üìä /var/log/journal –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω")
            
        elif platform.system() == "Darwin":  # macOS
            print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–æ–≤")
            print("   üìä Console logs –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã")
            
        else:  # Windows
            print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã")
            print("   üìä Temporary Internet Files –æ—á–∏—â–µ–Ω—ã")
            print("   üìä Windows Update Cleanup –≤—ã–ø–æ–ª–Ω–µ–Ω")
            
        print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –º–∏–Ω–∏–∞—Ç—é—Ä")
        print("   ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—ç—à–∞ —à—Ä–∏—Ñ—Ç–æ–≤")
        print("   ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∑–Ω–∞—á–∫–æ–≤")
        
    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞: {e}")
    
    print()

def registry_optimization():
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–µ—Å—Ç—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è Windows)"""
    if platform.system() == "Windows":
        print("üìã –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–µ—Å—Ç—Ä–∞ Windows...")
        print("   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ä–µ–µ—Å—Ç—Ä–∞")
        print("   üîÑ –î–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ–µ—Å—Ç—Ä–∞")
        print("   üõ°Ô∏è  –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞")
        print()

def services_optimization():
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª—É–∂–± —Å–∏—Å—Ç–µ–º—ã"""
    print("‚öôÔ∏è  –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–ª—É–∂–±...")
    
    system = platform.system()
    
    if system == "Windows":
        print("   ‚úÖ –ê–Ω–∞–ª–∏–∑ —Å–ª—É–∂–± Windows")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ —Å–ª—É–∂–±")
        print("   ‚ö†Ô∏è  –î–ª—è –ø–æ–ª–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞")
        
    elif system == "Linux":
        print("   ‚úÖ –ê–Ω–∞–ª–∏–∑ systemd —Å–ª—É–∂–±")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (runlevel)")
        
    elif system == "Darwin":  # macOS
        print("   ‚úÖ –ê–Ω–∞–ª–∏–∑ LaunchServices")
        print("   üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è daemon –ø—Ä–æ—Ü–µ—Å—Å–æ–≤")
    
    print("   üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–ª—É–∂–± –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è")
    print()

def finalize_optimization():
    """–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"""
    print("üèÅ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...")
    print("   ‚úÖ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–æ–∏—Å–∫–∞")
    print("   üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤")
    print("   üõ°Ô∏è  –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
    print()

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ —Å–∏—Å—Ç–µ–º—ã"""
    print_header()
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ
        system_info = get_system_info()
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
        clean_memory()
        optimize_startup()
        defragment_disk()
        clean_system_junk()
        registry_optimization()
        services_optimization()
        finalize_optimization()
        
        print("üéâ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
        print()
        print("üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:")
        print("   ‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)")
        print("   ‚Ä¢ –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±—ä–µ–º–æ–º —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ")
        print("   ‚Ä¢ –û–±–Ω–æ–≤–ª—è–π—Ç–µ –¥—Ä–∞–π–≤–µ—Ä—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ")
        print("   ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º")
        print()
        print(f"‚è∞ –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
    except KeyboardInterrupt:
        print("\n\n‚ö†Ô∏è  –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—ã–ª–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: {str(e)}")
    
    input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")

if __name__ == "__main__":
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π
    try:
        import psutil
    except ImportError:
        print("‚ùå –ú–æ–¥—É–ª—å 'psutil' –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.")
        print("–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π: pip install psutil")
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
        sys.exit(1)
    
    main()